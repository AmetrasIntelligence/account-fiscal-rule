=================
Ecotax Management
=================

.. 
   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
   !! This file is generated by oca-gen-addon-readme !!
   !! changes will be overwritten.                   !!
   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
   !! source digest: sha256:23479e79cea1c7653013329021c55bf27b1d6fa0d64734b13f53ca3209feaffa
   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

.. |badge1| image:: https://img.shields.io/badge/maturity-Beta-yellow.png
    :target: https://odoo-community.org/page/development-status
    :alt: Beta
.. |badge2| image:: https://img.shields.io/badge/licence-AGPL--3-blue.png
    :target: http://www.gnu.org/licenses/agpl-3.0-standalone.html
    :alt: License: AGPL-3
.. |badge3| image:: https://img.shields.io/badge/github-OCA%2Faccount--fiscal--rule-lightgray.png?logo=github
    :target: https://github.com/OCA/account-fiscal-rule/tree/16.0/account_ecotax
    :alt: OCA/account-fiscal-rule
.. |badge4| image:: https://img.shields.io/badge/weblate-Translate%20me-F47D42.png
    :target: https://translation.odoo-community.org/projects/account-fiscal-rule-16-0/account-fiscal-rule-16-0-account_ecotax
    :alt: Translate me on Weblate
.. |badge5| image:: https://img.shields.io/badge/runboat-Try%20me-875A7B.png
    :target: https://runboat.odoo-community.org/builds?repo=OCA/account-fiscal-rule&target_branch=16.0
    :alt: Try me on Runboat

|badge1| |badge2| |badge3| |badge4| |badge5|

This module applies to companies based in France mainland. It doesn't apply to
companies based in the DOM-TOMs (Guadeloupe, Martinique, Guyane, RÃ©union,
Mayotte).

It add Ecotaxe amount on invoice line.
furthermore, a total ecotaxe are added at the footer of each document.

To make easy ecotaxe management and to factor the data, ecotaxe are set on products via ECOTAXE classifications.
ECOTAXE classification can either a fixed or weight based ecotaxe.

A product can have one or serveral ecotaxe classifications. For exemple wooden window blinds equipped with electric motor can
have ecotaxe for wood and ecotaxe for electric motor.

This module version add the possibility to manage several ecotaxe classification by product.
A migration script is necessary to update from previous versions.

There is the main change to manage in migration script:

renamed field
model 			old field   		new field
account.move.line 	unit_ecotaxe_amount    ecotaxe_amount_unit
product.template        manual_fixed_ecotaxe   force_ecotaxe_amount

changed fields
model                 old field                    new field
product.template      ecotaxe_classification_id    ecotaxe_classification_ids

added fields
model 		    new field
account.move.line  ecotaxe_line_ids
product.template   ecotaxe_line_product_ids

**Table of contents**

.. contents::
   :local:

Usage
=====

1. Create a tax group named **"Ecotaxes"**. The sequence must be lower than other tax groups.
   - Set the **Preceding Subtotal** field to **"Without Ecotax"**.

2. Create two taxes named **"Fixed Ecotax"** and **"Weight-Based Ecotax"**.
   - Check the **Ecotax** checkbox.
   - Set the correct Python code:

     - For the fixed ecotax:

       .. code-block:: python

          result = quantity and product.fixed_ecotax * quantity or 0.0

     - For the weight-based ecotax:

       .. code-block:: python

          result = quantity and product.weight_based_ecotax * quantity or 0.0

   - Check the **Included in Base Amount** option.
   - The sequence for Ecotax must be lower than the VAT tax.

3. For VAT taxes, check the **Base Affected by Previous Taxes?** option.

4. Add an ecotax classification via the menu **Accounting > Configuration > Taxes > Ecotax Classification**.

   - The ecotax classification can be either a fixed ecotax or a weight-based ecotax.
   - Ecotax classification information can be used for legal declarations.
   - For the fixed ecotax, the ecotax amount is used as a default value, which can be overridden on the product.
   - For the weight-based ecotax, define one ecotax by a coefficient applied to the weight (depending on the product's materials).
   - Set the appropriate tax in the **Sale Ecotax** field.

5. Assign one or more ecotax classifications to a product.

   - The ecotax amount can also be manually overridden on the product.

Bug Tracker
===========

Bugs are tracked on `GitHub Issues <https://github.com/OCA/account-fiscal-rule/issues>`_.
In case of trouble, please check there if your issue has already been reported.
If you spotted it first, help us to smash it by providing a detailed and welcomed
`feedback <https://github.com/OCA/account-fiscal-rule/issues/new?body=module:%20account_ecotax%0Aversion:%2016.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**>`_.

Do not contact contributors directly about support or help with technical issues.

Credits
=======

Authors
~~~~~~~

* Akretion

Contributors
~~~~~~~~~~~~

* Mourad EL HADJ MIMOUNE <mourad.elhadj.mimoune@akretion.com>

Maintainers
~~~~~~~~~~~

This module is maintained by the OCA.

.. image:: https://odoo-community.org/logo.png
   :alt: Odoo Community Association
   :target: https://odoo-community.org

OCA, or the Odoo Community Association, is a nonprofit organization whose
mission is to support the collaborative development of Odoo features and
promote its widespread use.

.. |maintainer-mourad-ehm| image:: https://github.com/mourad-ehm.png?size=40px
    :target: https://github.com/mourad-ehm
    :alt: mourad-ehm

Current `maintainer <https://odoo-community.org/page/maintainer-role>`__:

|maintainer-mourad-ehm| 

This module is part of the `OCA/account-fiscal-rule <https://github.com/OCA/account-fiscal-rule/tree/16.0/account_ecotax>`_ project on GitHub.

You are welcome to contribute. To learn how please visit https://odoo-community.org/page/Contribute.
